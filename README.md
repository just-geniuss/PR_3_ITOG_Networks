# Система уведомлений - Клиент-серверное приложение Qt

## Описание

Это клиент-серверное приложение на Qt6 для передачи уведомлений по UDP протоколу с журналированием в базу данных SQLite. Система состоит из серверной части для отправки уведомлений и клиентской части для их получения с отображением в system tray.

## Технические характеристики

- **Язык программирования**: C++17
- **Фреймворк**: Qt6 (Widgets, Network, SQL)
- **База данных**: SQLite
- **Протокол связи**: UDP
- **ОС**: macOS (может быть адаптирована для Linux/Windows)

## Компоненты системы

### Серверная часть
- Отправка broadcast UDP сообщений на указанный порт
- Журналирование всех отправленных сообщений в базу данных
- Графический интерфейс для управления сервером
- Возможность настройки порта и имени файла БД

### Клиентская часть  
- Прием UDP сообщений от сервера
- Отображение уведомлений в system tray
- Журнал полученных сообщений
- Возможность сворачивания в системный трей

## Установка и компиляция

### Требования
- Qt6 (установка через Homebrew: `brew install qt6`)
- Xcode Command Line Tools
- macOS 14.0+

### Компиляция
```bash
# Клонируйте или загрузите проект
cd QT_PR3

# Убедитесь, что Qt6 в PATH
export PATH="/opt/homebrew/opt/qt/bin:$PATH"

# Генерация Makefile
qmake PR3.pro

# Компиляция
make

# Запуск
./PR3.app/Contents/MacOS/PR3
```

## Использование

### Запуск приложения

При запуске без параметров приложение покажет диалог выбора режима (сервер или клиент).

#### Параметры командной строки:
```bash
# Запуск сервера
./PR3.app/Contents/MacOS/PR3 --server

# Запуск клиента  
./PR3.app/Contents/MacOS/PR3 --client

# Справка по параметрам
./PR3.app/Contents/MacOS/PR3 --help
```

### Настройка сервера

1. Запустите приложение в режиме сервера
2. Настройте параметры:
   - **Порт**: UDP порт для отправки сообщений (по умолчанию 12345)
   - **Имя файла БД**: имя файла SQLite для журналирования (по умолчанию "notifications")
3. Нажмите "Запустить сервер"
4. Введите сообщение в поле и нажмите "Отправить уведомление"

### Настройка клиента

1. Запустите приложение в режиме клиента
2. Настройте порт приема (по умолчанию 12346 = порт_сервера + 1)
3. Нажмите "Запустить клиент"
4. Клиент будет слушать входящие сообщения
5. При получении сообщения оно отобразится в system tray и в журнале

### Особенности work flow

1. **Сервер** отправляет broadcast сообщения на порт `N+1`, где `N` - порт сервера
2. **Клиент** слушает порт `N+1` для получения сообщений
3. Все отправленные сообщения записываются в SQLite БД с timestamp
4. Клиент может быть свернут в system tray для работы в фоне
5. При получении уведомления в трее показывается popup с текстом сообщения

## Структура проекта

```
QT_PR3/
├── main.cpp              # Точка входа с парсером аргументов
├── server.h/cpp          # Класс UDP сервера
├── client.h/cpp          # Класс UDP клиента с system tray
├── database.h/cpp        # Класс для работы с SQLite
├── serverwindow.h/cpp    # GUI окно сервера
├── clientwindow.h/cpp    # GUI окно клиента
├── PR3.pro              # Файл проекта Qt
└── notifications.db     # SQLite база данных (создается автоматически)
```

## База данных

Приложение автоматически создает SQLite базу данных со схемой:

```sql
CREATE TABLE IF NOT EXISTS messages (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    message TEXT NOT NULL,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

## Тестирование

1. Запустите сервер на одном терминале:
   ```bash
   ./PR3.app/Contents/MacOS/PR3 --server
   ```

2. Запустите клиент на другом терминале:
   ```bash
   ./PR3.app/Contents/MacOS/PR3 --client
   ```

3. В окне сервера введите сообщение и отправьте
4. Проверьте получение сообщения в клиенте и system tray

## Возможные проблемы

- **System tray недоступен**: На некоторых системах system tray может быть недоступен
- **Порты заняты**: Убедитесь, что указанные UDP порты свободны
- **Права доступа**: Для записи БД нужны права на запись в текущую директорию

## Автор

Разработано как учебный проект для демонстрации клиент-серверной архитектуры с Qt6.
